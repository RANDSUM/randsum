---
import BaseLayout from './BaseLayout.astro'
import Sidebar from '../components/Sidebar.astro'

export interface Props {
  title: string
  description?: string
}

const { title, description } = Astro.props
const currentPath = Astro.url.pathname
---

<BaseLayout title={title} description={description}>
  <div class="flex min-h-screen">
    <!-- Sidebar -->
    <div class="hidden lg:block fixed left-0 top-16 bottom-0 z-30">
      <Sidebar currentPath={currentPath} />
    </div>

    <!-- Mobile sidebar overlay -->
    <div
      id="sidebar-overlay"
      class="lg:hidden fixed inset-0 z-40 bg-gray-950/80 backdrop-blur-sm"
      style="display: none;"
    >
      <div class="fixed left-0 top-0 bottom-0 w-64">
        <Sidebar currentPath={currentPath} />
      </div>
    </div>

    <!-- Main content -->
    <div class="flex-1 lg:ml-64">
      <div class="container max-w-4xl py-8">
        <!-- Mobile sidebar toggle -->
        <button
          id="sidebar-toggle"
          class="lg:hidden mb-6 btn btn-ghost p-2"
          aria-label="Toggle sidebar"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
          <span class="ml-2 text-sm">Menu</span>
        </button>

        <!-- Page content -->
        <article class="prose prose-invert max-w-none">
          <slot />
        </article>
      </div>
    </div>
  </div>
</BaseLayout>

<script>
  // Mobile sidebar toggle
  const sidebarToggle = document.getElementById('sidebar-toggle')
  const sidebarOverlay = document.getElementById('sidebar-overlay')

  if (sidebarToggle && sidebarOverlay) {
    sidebarToggle.addEventListener('click', () => {
      sidebarOverlay.style.display = 'block'
    })

    sidebarOverlay.addEventListener('click', (e) => {
      if (e.target === sidebarOverlay) {
        sidebarOverlay.style.display = 'none'
      }
    })
  }
</script>
